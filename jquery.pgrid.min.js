/*
 * jQuery Pines Grid (pgrid) Plugin 1.1.2
 *
 * Copyright (c) 2010-2011 Hunter Perrin
 *
 * Triple license under the GPL, LGPL, and MPL:
 *	  http://www.gnu.org/licenses/gpl.html
 *	  http://www.gnu.org/licenses/lgpl.html
 *	  http://www.mozilla.org/MPL/MPL-1.1.html
 */
(function(b){b.fn.pgrid_add=function(f,c){if(!f)return this;this.each(function(){if(this.pines_grid){var a=this.pines_grid,m="";b.each(f,function(){m+="<tr"+(typeof this.key!="undefined"?' title="'+String(this.key)+'"':"")+(typeof this.classes!="undefined"?' class="'+String(this.classes)+'"':"")+">";m+="<td>"+this.values.join("</td><td>")+"</td></tr>"});var g=a.children("tbody").detach(),i=b(m).appendTo(g);a.init_rows(i);a.do_col_hiding(!0,i);a.do_sort(!1,!0,g);a.do_filter(!1,!0,g);a.append(g);a.paginate(!0);
a.update_selected();c&&i.each(c)}});return this};b.fn.pgrid_delete=function(f){if(f)this.each(function(){var a=this.pines_grid;a&&(f.jquery?f.each(function(){a.mark_for_delete_recursively(b(this))}):b.each(f,function(){typeof this=="object"?a.mark_for_delete_recursively(b(this)):a.children("tbody").children("[title="+this+"]").each(function(){a.mark_for_delete_recursively(b(this))})}),a.delete_marked())});else{var c=this.closest("table.ui-pgrid-table").get(0);if(c)c=c.pines_grid;if(!c)return this;
this.each(function(){c.mark_for_delete_recursively(b(this))});c.delete_marked()}return this};b.fn.pgrid_export_rows=function(f){var c=[];f||(f=this);b.each(f,function(){var a=b(this),f=a.attr("title"),g=a.attr("class"),i=[];a.children().not(".ui-pgrid-table-expander").each(function(){i=b.merge(i,[b(this).text()])});c=b.merge(c,[{key:typeof f=="undefined"?"":f,classes:typeof g=="undefined"?"":g.replace(/\bui-[a-z0-9 \-]+/,""),values:i}])});return c};b.fn.pgrid_expand_rows=function(b){var c=null;b?
c=this.get(0):(b=this,c=b.closest(".ui-pgrid-table").get(0));if(c&&c.pines_grid)c=c.pines_grid;if(!c)return this;if(!b.jquery){if(typeof b!="object")return this;b=c.children("tbody").children("[title='"+b.join("'], [title='")+"']")}b=b.filter(".parent").addClass("ui-pgrid-table-row-expanded");c.show_children(b);return this};b.fn.pgrid_collapse_rows=function(b){var c=null;b?c=this.get(0):(b=this,c=b.closest(".ui-pgrid-table").get(0));if(c&&c.pines_grid)c=c.pines_grid;if(!c)return this;if(!b.jquery){if(typeof b!=
"object")return this;b=c.children("tbody").children("[title='"+b.join("'], [title='")+"']")}b=b.filter(".parent").removeClass("ui-pgrid-table-row-expanded");c.hide_children(b);return this};b.fn.pgrid_select_rows=function(b){var c=null;b?c=this.get(0):(b=this,c=b.closest(".ui-pgrid-table").get(0));if(c&&c.pines_grid)c=c.pines_grid;if(!c)return this;if(!b.jquery){if(typeof b!="object")return this;b=c.children("tbody").children("[title='"+b.join("'], [title='")+"']")}if(c.pgrid_select){if((c.children("tbody").children(".ui-pgrid-table-row-selected").length||
b.length>1)&&!c.pgrid_multi_select)return this;b.addClass("ui-pgrid-table-row-selected ui-state-active");c.update_selected()}return this};b.fn.pgrid_deselect_rows=function(b){var c=null;b?c=this.get(0):(b=this,c=b.closest("table.ui-pgrid-table").get(0));if(c&&c.pines_grid)c=c.pines_grid;if(!c)return this;if(!b.jquery){if(typeof b!="object")return this;b=c.children("tbody").children("[title='"+b.join("'], [title='")+"']")}c.pgrid_select&&(b.removeClass("ui-pgrid-table-row-selected ui-state-active"),
c.update_selected());return this};b.fn.pgrid_get_all_rows=function(){var b=!1;this.each(function(){if(this.pines_grid.jquery){var c=this.pines_grid;b=b?b.add(c.children("tbody").children()):c.children("tbody").children()}});return b};b.fn.pgrid_get_selected_rows=function(){var b=!1;this.each(function(){if(this.pines_grid.jquery){var c=this.pines_grid;b=b?b.add(c.children("tbody").children(".ui-pgrid-table-row-selected")):c.children("tbody").children(".ui-pgrid-table-row-selected")}});return b};b.fn.pgrid_add_descendent_rows=
function(){var f=b(this),c=null;if((c=f.closest("table.ui-pgrid-table").get(0))&&c.pines_grid)c=c.pines_grid;if(!c)return this;this.filter(".parent").each(function(){var a=b(this),a=a.siblings("."+c.pgrid_child_prefix+a.attr("title"));f=f.add(a.pgrid_add_descendent_rows())});return f};b.fn.pgrid_get_value=function(f){return b(this).eq(0).children(":nth-child("+(f+1)+")").html()};b.fn.pgrid_set_value=function(b,c){this.children(":nth-child("+(b+1)+")").html(c)};b.fn.pgrid_export_state=function(){var b=
this.get(0);if(b&&b.pines_grid)b=b.pines_grid;if(b.jquery)return b.export_state();return!1};b.fn.pgrid_import_state=function(b){this.each(function(){this.pines_grid&&this.pines_grid.import_state(b)});return this};b.fn.pgrid=function(f){var c=b.extend({},b.fn.pgrid.defaults,f);this.filter("table").not(".ui-pgrid-table").each(function(){var a=b(this);a.pgrid_version="1.1.2";a.extend(a,c);a.pgrid_pages=null;a.pgrid_widget=b("<div />");a.pgrid_table_container=b("<div />");a.pgrid_header_select=b("<div />");
a.wrapAll(a.pgrid_widget);a.pgrid_widget=a.parent();a.detach();a.pgrid_widget.addClass("ui-pgrid ui-widget ui-widget-content ui-corner-all");a.pgrid_table_container.addClass("ui-pgrid-table-container");a.pgrid_table_container.append(a);a.addClass("ui-pgrid-table");a.pgrid_select&&a.addClass("ui-pgrid-selectable");a.pgrid_toolbar_contents=a.pgrid_toolbar_contents.slice();a.pgrid_hidden_cols=a.pgrid_hidden_cols.slice();if(!a.pgrid_hidden_cols.indexOf)a.pgrid_hidden_cols.indexOf=function(a,b){var c=
this.length>>>0,k=Number(b)||0,k=k<0?Math.ceil(k):Math.floor(k);for(k<0&&(k+=c);k<c;k++)if(k in this&&this[k]===a)return k;return-1};a.export_state=function(){var b={pgrid_page:a.pgrid_page,pgrid_perpage:a.pgrid_perpage,pgrid_filter:a.pgrid_filter,pgrid_hidden_cols:a.pgrid_hidden_cols.slice(),pgrid_sort_col:a.pgrid_sort_col,pgrid_sort_ord:a.pgrid_sort_ord};if(a.pgrid_stateful_height)b.pgrid_view_height=a.pgrid_table_viewport.css("height");return b};a.import_state=function(b){if(typeof b.pgrid_page==
"number")a.pgrid_page=b.pgrid_page;if(typeof b.pgrid_perpage=="number")a.pgrid_perpage=b.pgrid_perpage;if(typeof b.pgrid_filter=="string")a.pgrid_filter=b.pgrid_filter;if(typeof b.pgrid_hidden_cols=="object")a.pgrid_hidden_cols=b.pgrid_hidden_cols.slice(0);if(typeof b.pgrid_sort_col=="number")a.pgrid_sort_col=b.pgrid_sort_col;if(typeof b.pgrid_sort_ord=="string")a.pgrid_sort_ord=b.pgrid_sort_ord!="desc"?"asc":"desc";a.pgrid_stateful_height&&typeof b.pgrid_view_height=="string"&&a.pgrid_table_viewport.css("height",
b.pgrid_view_height);a.do_filter(a.pgrid_filter);a.do_sort();a.do_col_hiding();a.pgrid_footer&&a.pgrid_filtering&&a.footer.children(".ui-pgrid-footer-filter-container").find("input.ui-pgrid-footer-filter-input").val(a.pgrid_filter);a.pgrid_footer&&a.pgrid_paginate&&a.footer.children(".ui-pgrid-footer-pager-container").find("input.ui-pgrid-per-page").val(a.pgrid_perpage)};a.state_changed=function(){if(a.pgrid_state_change)return a.pgrid_state_change(a.export_state());return null};a.pagestart=function(){a.pgrid_page=
0;a.paginate()};a.pageprev=function(){a.pgrid_page--;if(a.pgrid_page<0)a.pgrid_page=0;a.paginate()};a.pagenext=function(){a.pgrid_page++;if(a.pgrid_page>=a.pgrid_pages)a.pgrid_page=a.pgrid_pages-1;a.paginate()};a.pageend=function(){a.pgrid_page=a.pgrid_pages-1;a.paginate()};a.pagenum=function(b){a.pgrid_page=b;if(isNaN(a.pgrid_page)||a.pgrid_page<0)a.pgrid_page=0;else if(a.pgrid_page>=a.pgrid_pages)a.pgrid_page=a.pgrid_pages-1;a.paginate()};a.set_per_page=function(b){a.pgrid_page=0;a.pgrid_perpage=
b;if(a.pgrid_perpage===0)a.pgrid_perpage=1;a.paginate()};a.hide_children=function(d){d=d.filter(".parent");d.length&&(d.children(".ui-pgrid-table-expander").children(".ui-icon").removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e"),d.each(function(){var e=b(this);e.siblings("tr."+a.pgrid_child_prefix+e.attr("title")+".ui-pgrid-table-row-visible").removeClass("ui-pgrid-table-row-visible").filter(".parent").each(function(){a.hide_children(b(this))})}))};a.show_children=function(d){d=
d.filter(".parent.ui-pgrid-table-row-expanded");d.length&&(d.children(".ui-pgrid-table-expander").children(".ui-icon").removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s"),d.each(function(){var e=b(this);e.siblings("tr."+a.pgrid_child_prefix+e.attr("title")).addClass("ui-pgrid-table-row-visible").filter(".parent.ui-pgrid-table-row-expanded").each(function(){a.show_children(b(this))})}))};a.place_children=function(d){d=d.filter(".parent");d.length&&d.each(function(){var e=b(this),d=
e.siblings("."+a.pgrid_child_prefix+e.attr("title"));e.after(d);a.place_children(d.filter(".parent"))})};a.mark_for_delete_recursively=function(d){d.each(function(){var e=b(this),d=e.attr("title");typeof d!="undefined"&&d!=""&&e.siblings("."+a.pgrid_child_prefix+d).each(function(){var e=b(this);e.hasClass("parent")?a.mark_for_delete_recursively(e):e.addClass("ui-pgrid-table-row-marked-for-deletion")});e.addClass("ui-pgrid-table-row-marked-for-deletion")})};a.delete_marked=function(){a.children("tbody").children(".ui-pgrid-table-row-marked-for-deletion").remove();
a.do_sort(!1,!0);a.do_filter(!1,!0);a.paginate(!0);a.update_selected()};a.paginate=function(d){if(a.pgrid_paginate){var e=a.children("tbody").children().not(".ui-helper-hidden, .child");if(isNaN(a.pgrid_perpage)||a.pgrid_perpage<1)a.pgrid_perpage=b.fn.pgrid.defaults.pgrid_perpage;a.pgrid_pages=Math.ceil(e.length/a.pgrid_perpage);if(a.pgrid_page+1>a.pgrid_pages)a.pgrid_page=a.pgrid_pages-1;else if(a.pgrid_page==-1&&a.pgrid_pages>0)a.pgrid_page=0;a.cur_page_rows&&a.hide_children(a.cur_page_rows.removeClass("ui-pgrid-table-row-visible"));
a.cur_page_rows=e.slice(a.pgrid_page*a.pgrid_perpage,a.pgrid_page*a.pgrid_perpage+a.pgrid_perpage);a.cur_page_rows.addClass("ui-pgrid-table-row-visible");a.show_children(a.cur_page_rows);if(a.pgrid_footer){if(!a.page_number_elem)a.page_number_elem=a.footer.find("input.ui-pgrid-page-number");a.page_number_elem.val(a.pgrid_page+1);if(!a.page_total_elem)a.page_total_elem=a.footer.find("span.ui-pgrid-page-total");a.page_total_elem.html(a.pgrid_pages)}}d||a.state_changed()};a.paginate_queue=function(){a.paginate_timout&&
window.clearTimeout(a.paginate_timout);a.paginate_timout=window.setTimeout(a.paginate,50)};a.animate_filter=function(b){b?a.footer_input.stop(!0).fadeTo(400,1):a.footer_input.fadeTo(1E3,0.7).fadeTo(1E3,0.8,a.animate_filter)};a.do_filter=function(b,e,c){if(a.pgrid_filtering||e){a.footer_input&&(a.footer_input.addClass("ui-state-highlight"),a.animate_filter());a.filter_timer&&window.clearInterval(a.filter_timer);if(typeof b=="string")a.pgrid_filter=b;if(a.pgrid_filter.length>0){var f=a.pgrid_filter.toLowerCase().split(" "),
h=0;c||(c=a.children("tbody"));var g=c.children();a.filter_timer=window.setInterval(function(){var b,d,c,j;do{b=g.eq(h);if(!b.length){window.clearInterval(a.filter_timer);a.footer_input&&(a.footer_input.removeClass("ui-state-highlight"),a.animate_filter(!0));break}h++;d=b.get();d.pgrid_filter_text?c=d.pgrid_filter_text:(c=d.innerText!=void 0?d.innerText.toLowerCase():d.textContent!=void 0?d.textContent.toLowerCase():b.text().toLowerCase(),d.pgrid_filter_text=c);d=!0;for(j in f)if(c.indexOf(f[j])==
-1){d=!1;break}b.hasClass("ui-helper-hidden")?d&&b.removeClass("ui-helper-hidden"):d||b.addClass("ui-helper-hidden");d&&b.hasClass("child")&&a.enable_parents(b)}while(h%25);e||(a.paginate_queue(),a.update_selected_queue())},1)}else a.children("tbody").children(".ui-helper-hidden").removeClass("ui-helper-hidden"),a.footer_input&&(a.footer_input.removeClass("ui-state-highlight"),a.animate_filter(!0)),e||(a.paginate(),a.update_selected())}};a.enable_parents=function(d){d.filter(".child").each(function(){var d=
b(this);d.siblings("tr.parent").each(function(){var c=b(this);d.hasClass(a.pgrid_child_prefix+c.attr("title"))&&(c.removeClass("ui-helper-hidden"),a.enable_parents(c))})})};a.do_sort=function(d,e,c){if(a.pgrid_sortable){d&&(typeof d=="string"&&(d=d.replace(/\D/g,"")),d=parseInt(d));if(!e)if(a.pgrid_sort_col==d)a.pgrid_sort_ord=a.pgrid_sort_ord=="asc"?"desc":"asc";else if(d)a.pgrid_sort_col=d,a.pgrid_sort_ord="asc";d=a.children("thead").children().children();d.children(".ui-pgrid-table-header-sorted-asc, .ui-pgrid-table-header-sorted-desc").removeClass("ui-pgrid-table-header-sorted-asc ui-pgrid-table-header-sorted-desc ui-icon-triangle-1-s ui-icon-triangle-1-n");
a.pgrid_sort_ord=="asc"?d.filter(":nth-child("+(a.pgrid_sort_col+1)+")").children(".ui-icon").addClass("ui-pgrid-table-header-sorted-desc ui-icon-triangle-1-n"):d.filter(":nth-child("+(a.pgrid_sort_col+1)+")").children(".ui-icon").addClass("ui-pgrid-table-header-sorted-asc ui-icon-triangle-1-s");d=!1;c||(c=a.children("tbody").detach(),d=!0);var f=c.children();f.children(".ui-pgrid-table-cell-sorted").removeClass("ui-pgrid-table-cell-sorted");f.children(":nth-child("+(a.pgrid_sort_col+1)+")").addClass("ui-pgrid-table-cell-sorted");
f=f.get();b.each(f,function(){var d=this.children[a.pgrid_sort_col];if(typeof d!="undefined"){d=d.innerText!=void 0?d.innerText.toLowerCase():d.textContent!=void 0?d.textContent.toLowerCase():b(d).text().toLowerCase();this.sortKey=[];for(var e=0,c=-1,f=0,l,j;l=(j=d.charAt(e++)).charCodeAt(0);)l=l==46||l>=48&&l<=57,l!==f&&(this.sortKey[++c]="",f=l),this.sortKey[c]+=j}});f.sort(function(a,b){for(var d=a.sortKey,e=b.sortKey,c=0,f,j;(f=d[c])&&(j=e[c]);c++)if(f!==j)return d=Number(f),e=Number(j),d==f&&
e==j?d-e:f>j?1:-1;return d.length-e.length});a.pgrid_sort_ord=="desc"&&f.reverse();f=b(f);c.append(f);a.place_children(f.filter(".parent").not(".child"));d&&a.append(c);e||a.paginate()}};a.update_selected=function(){a.pgrid_select&&(a.children("tbody").children(".ui-helper-hidden.ui-pgrid-table-row-selected").removeClass("ui-pgrid-table-row-selected ui-state-active"),a.pgrid_footer&&a.pgrid_count&&a.footer.children(".ui-pgrid-footer-count-container").find("span.ui-pgrid-footer-count-select").html(a.children("tbody").children(".ui-pgrid-table-row-selected").length));
a.update_count()};a.update_selected_queue=function(){a.update_selected_timout&&window.clearTimeout(a.update_selected_timout);a.update_selected_timout=window.setTimeout(a.update_selected,200)};a.update_count=function(){a.pgrid_footer&&a.pgrid_count&&a.footer.children(".ui-pgrid-footer-count-container").find("span.ui-pgrid-footer-count-total").html(a.children("tbody").children().not(".ui-helper-hidden").length)};a.do_col_hiding=function(d,e){var c=a.children("thead").children();e||(e=a.children("tbody").children());
d||c.children(":hidden").each(function(){var a=b(this).show();e.children(":nth-child("+(a.prevAll().length+1)+")").show()});var f=a.pgrid_header_select.children().children();f.attr("checked",!0);for(var h in a.pgrid_hidden_cols)isNaN(h)||(f.filter(".ui-pgrid-table-col-hider-"+a.pgrid_hidden_cols[h]).removeAttr("checked"),c.children(":nth-child("+(a.pgrid_hidden_cols[h]+1)+")").hide(),e.children(":nth-child("+(a.pgrid_hidden_cols[h]+1)+")").hide());d||a.state_changed()};a.hide_col=function(b){a.pgrid_hidden_cols.indexOf(b)==
-1&&(a.pgrid_hidden_cols.push(b),a.pgrid_header_select.children().children(".ui-pgrid-table-col-hider-"+b).removeAttr("checked"),a.children("thead").children().children(":nth-child("+(b+1)+")").hide(),a.children("tbody").children().children(":nth-child("+(b+1)+")").hide(),a.state_changed())};a.show_col=function(b){a.pgrid_hidden_cols.indexOf(b)!=-1&&(a.pgrid_hidden_cols.splice(a.pgrid_hidden_cols.indexOf(b),1),a.pgrid_header_select.children().children(".ui-pgrid-table-col-hider-"+b).attr("checked",
!0),a.children("thead").children().children(":nth-child("+(b+1)+")").show(),a.children("tbody").children().children(":nth-child("+(b+1)+")").show(),a.state_changed())};a.init_rows=function(b){b&&(b.addClass("ui-state-default").prepend('<td class="ui-pgrid-table-expander"></td>'),a.init_children(b.filter(".parent").not(".child")))};a.init_children=function(d){d.length&&d.each(function(){var d=b(this),c=parseInt(d.children(":last-child").css("padding-left"));isNaN(c)&&(c=0);a.init_children(d.siblings("."+
a.pgrid_child_prefix+d.attr("title")).each(function(){b(this).children().not(".ui-pgrid-table-expander").css("padding-left",c+10+"px")}).filter(".parent"))}).children(".ui-pgrid-table-expander").append(b("<span />").addClass("ui-icon ui-icon-triangle-1-e"))};a.children("tbody").delegate("tr.parent td.ui-pgrid-table-expander","click",function(){var d=b(this).parent();d.hasClass("ui-pgrid-table-row-expanded")?(d.removeClass("ui-pgrid-table-row-expanded"),a.hide_children(d)):(d.addClass("ui-pgrid-table-row-expanded"),
a.show_children(d))});a.pgrid_row_hover_effect&&a.children("tbody").delegate("tr","mouseover",function(){b(this).addClass("ui-state-hover")}).delegate("tr","mouseout",function(){b(this).removeClass("ui-state-hover")});a.pgrid_select&&a.children("tbody").delegate("tr","click",function(d){if(!b(d.target).parent().andSelf().hasClass("ui-pgrid-table-expander")){var e=b(this);!a.pgrid_multi_select||!d.ctrlKey&&!d.shiftKey?e.siblings().removeClass("ui-pgrid-table-row-selected ui-state-active"):d.shiftKey&&
e.prevUntil(".ui-pgrid-table-row-selected").addClass("ui-pgrid-table-row-selected ui-state-active");d.ctrlKey?e.toggleClass("ui-pgrid-table-row-selected").toggleClass("ui-state-active"):e.addClass("ui-pgrid-table-row-selected ui-state-active");a.update_selected();a.pgrid_click&&a.pgrid_click(d,a.children("tbody").children(".ui-pgrid-table-row-selected"))}}).delegate("tr","dblclick",function(d){b(d.target).hasClass("ui-pgrid-table-expander")||(b(this).addClass("ui-pgrid-table-row-selected ui-state-active"),
a.pgrid_double_click&&a.pgrid_double_click(d,a.children("tbody").children(".ui-pgrid-table-row-selected")),a.pgrid_double_click_tb&&a.pgrid_double_click_tb())}).delegate("tr","mousedown",function(a){return!(a.ctrlKey||a.shiftKey)});var f=a.children("thead").children();f.children().each(function(d){var e=b(this);a.pgrid_header_select.append(b("<label></label>").addClass("ui-state-default ui-corner-all").append(b('<input type="checkbox" />').change(function(b){b.target.checked?a.show_col(d+1):a.hide_col(d+
1)}).addClass("ui-pgrid-table-col-hider-"+(d+1))).append(e.text()))});a.pgrid_header_select.addClass("ui-pgrid-header-select ui-widget-header ui-corner-all");a.pgrid_header_select.mouseenter(function(){b(this).mouseleave(function(){b(this).fadeOut("fast").unbind("mouseleave")})});a.resizing_header=!1;a.resizing_tempX=0;var g=b("<div />").addClass("ui-pgrid-table-header-text");a.pgrid_sortable&&g.addClass("ui-pgrid-table-header-sortable");g=f.children().not(".ui-pgrid-table-expander").mouseup(function(){a.resizing_header?
a.resizing_header=!1:a.do_sort(b(this).prevAll().length)}).wrapInner(g).append(b("<span />").addClass("ui-icon"));a.pgrid_resize_cols&&g.addClass("ui-pgrid-table-header-resizeable").mousedown(function(d){var e=b(this),c=d.pageX-e.offset().left;if(c<4&&e.hasClass("ui-pgrid-table-expander")||c>3&&c<e.width()-4)return!0;a.resizing_header=!0;a.resizing_tempX=d.pageX;a.resizing_cur=c<4?e.prev().children(".ui-pgrid-table-header-text"):e.children(".ui-pgrid-table-header-text");return!1});delete g;a.pgrid_resize_cols&&
a.pgrid_widget.mousemove(function(b){if(a.resizing_header){var e=a.resizing_cur.width()+b.pageX-a.resizing_tempX;if(e>0)a.resizing_tempX=b.pageX,a.resizing_cur.width(e)}}).mouseup(function(){a.resizing_header=!1});f.addClass("ui-widget-header").prepend(b('<th class="ui-icon ui-pgrid-table-icon-hidden ui-pgrid-table-expander"><div style="width: 16px; visibility: hidden;">+</div></th>').click(function(b){var e=a.pgrid_widget.offset();a.pgrid_header_select.css({left:b.pageX-e.left-5,top:b.pageY-e.top-
5});a.pgrid_header_select.fadeIn("fast")}).mouseover(function(){b(this).removeClass("ui-pgrid-table-icon-hidden").addClass("ui-icon-triangle-1-s")}).mouseout(function(){b(this).addClass("ui-pgrid-table-icon-hidden").removeClass("ui-icon-triangle-1-s")}));delete f;a.init_rows(a.children("tbody").children());a.do_col_hiding(!0);a.pgrid_table_viewport=b('<div class="ui-pgrid-table-viewport ui-widget-content" />');a.pgrid_table_container.appendTo(a.pgrid_table_viewport);a.pgrid_table_viewport.height(a.pgrid_view_height);
a.pgrid_view_height!="auto"&&a.pgrid_table_container.css({position:"absolute",top:"0",bottom:"0",left:"0",right:"0"});if(a.pgrid_toolbar)a.toolbar=b("<div />").addClass("ui-pgrid-toolbar").delegate("button","focus",function(){b(this).addClass("ui-state-focus")}).delegate("button","blur",function(){b(this).removeClass("ui-state-focus ui-state-active")}).delegate("button","mousedown",function(){b(this).addClass("ui-state-active")}).delegate("button","mouseup",function(){b(this).removeClass("ui-state-active")}).delegate("button",
"mouseenter",function(){b(this).addClass("ui-state-hover")}).delegate("button","mouseleave",function(){b(this).removeClass("ui-state-hover")}),b.each(a.pgrid_toolbar_contents,function(d,e){if(e.type=="button"){var c=b('<button class="ui-pgrid-toolbar-button ui-state-default ui-corner-all" type="button" />').append(b(typeof e.text=="undefined"?"<span></span>":"<span>"+e.text+"</span>").each(function(){e.extra_class&&b(this).addClass(e.extra_class)})).click(function(d){if(d.button==2)return!0;var c=
e.return_all_rows?a.children("tbody").children().not(".ui-helper-hidden"):a.children("tbody").children(".ui-pgrid-table-row-selected");if(!e.selection_optional&&!e.select_all&&!e.select_none&&c.length===0)return alert("Please make a selection before performing this operation."),!1;if(!e.multi_select&&!e.selection_optional&&!e.select_all&&!e.select_none&&c.length>1)return alert("Please choose only one item before performing this operation."),!1;if(e.confirm)if(typeof e.confirm=="function"){if(!e.confirm(d,
c))return!1}else{var f="";typeof e.text!="undefined"?f=' "'+e.text+'"':typeof e.title!="undefined"&&(f=' "'+e.title+'"');if(e.return_all_rows){if(!confirm("Are you sure you want to perform the operation"+f+" on all items?"))return!1}else if(c.length===0){if(!confirm("Are you sure you want to perform the operation"+f+"?"))return!1}else if(!confirm("Are you sure you want to perform the operation"+f+" on the "+c.length+" currently selected item(s)?"))return!1}e.select_all&&a.pgrid_select&&a.pgrid_multi_select&&
(a.children("tbody").children().not(".ui-helper-hidden").addClass("ui-pgrid-table-row-selected ui-state-active"),a.update_selected());e.select_none&&a.pgrid_select&&(a.children("tbody").children().removeClass("ui-pgrid-table-row-selected ui-state-active"),a.update_selected());if(e.click){var g="";e.pass_csv||e.pass_csv_with_headers?(e.pass_csv_with_headers&&(c=a.children("thead").children().add(c)),c.each(function(){b(this).children().not(".ui-pgrid-table-expander").each(function(){var a=b(this);
g+='"'+a.contents().text().replace(/"/g,'""')+'"';a.next()&&(g+=",")});g+="\n"})):g=c;return e.click(d,g)}else if(e.url){var f=e.url,h="",i=[];c.each(function(){var a=b(this),d=a.children().not(".ui-pgrid-table-expander");h+=(h.length?e.delimiter:"")+n(a.attr("title"));d.each(function(a){i[a+1]?i[a+1]+=e.delimiter+n(b(this).contents().text()):i[a+1]=n(b(this).contents().text())})});var f=f.replace("__title__",h),j;for(j in i)isNaN(j)||(f=f.replace("__col_"+j+"__",i[j]));if(d.button==1||!e.target&&
a.pgrid_toolbar_target!="_self"||e.target&&e.target!="_self"){d=e.target?e.target:a.pgrid_toolbar_target;if(e.window_features)return window.open(f,d,e.window_features);return window.open(f,d)}else{if(typeof pines!="undefined"&&pines.get)return pines.get(f);return window.location=f}}return!0});typeof e.title!="undefined"&&c.attr("title",e.title);if(e.double_click){if(a.pgrid_double_click_tb)var f=a.pgrid_double_click_tb;a.pgrid_double_click_tb=function(){f&&f();c.click()}}a.toolbar.append(c)}else if(e.type==
"text"){var h=b("<div />").addClass("ui-pgrid-toolbar-text");e.extra_class&&h.addClass(e.extra_class);typeof e.title!="undefined"&&h.attr("title",e.title);e.label&&h.append(b("<span>"+e.label+"</span>").addClass("ui-pgrid-toolbar-text-label"));var g=b('<input type="text" />').addClass("ui-widget ui-widget-content ui-corner-all");e.dont_prevent_default||g.keydown(function(a){a.keyCode==13&&a.preventDefault()});e.attributes&&g.attr(e.attributes);h.append(g);a.toolbar.append(h);e.load&&e.load(g)}else e.type==
"label"?(h=b("<div>"+e.label+"</div>").addClass("ui-pgrid-toolbar-label"),e.extra_class&&h.addClass(e.extra_class),typeof e.title!="undefined"&&h.attr("title",e.title),a.toolbar.append(h),e.load&&e.load(h)):e.type=="separator"&&a.toolbar.append(b("<div />").addClass("ui-pgrid-toolbar-sep ui-state-default").append(b("<div>-</div>").addClass("ui-pgrid-toolbar-blank")))});if(a.pgrid_footer&&(a.footer=b("<div />").addClass("ui-pgrid-footer ui-widget-header ui-corner-bottom ui-helper-clearfix").delegate("button",
"focus",function(){b(this).addClass("ui-state-focus")}).delegate("button","blur",function(){b(this).removeClass("ui-state-focus ui-state-active")}).delegate("button","mousedown",function(){b(this).addClass("ui-state-active")}).delegate("button","mouseup",function(){b(this).removeClass("ui-state-active")}).delegate("button","mouseenter",function(){b(this).addClass("ui-state-hover")}).delegate("button","mouseleave",function(){b(this).removeClass("ui-state-hover")}),a.pgrid_filtering))a.footer.append(b("<div />").addClass("ui-pgrid-footer-filter-container").each(function(){b(this).append(b("<span>Filter: </span>").append(b("<input />").addClass("ui-pgrid-footer-filter-input ui-widget ui-widget-content ui-corner-all").attr({type:"text",
value:a.pgrid_filter,size:"10"}).keyup(function(){a.do_filter(b(this).val())})).append(b('<button type="button">X</button>').addClass("ui-state-default ui-corner-all").click(function(){b(this).prev("input").val("").keyup().focus()})))})),a.footer_input=a.footer.find("input.ui-pgrid-footer-filter-input");a.pgrid_filter!=""&&a.do_filter(a.pgrid_filter,!0);if(a.pgrid_sort_col){if(typeof a.pgrid_sort_col=="string")a.pgrid_sort_col=a.pgrid_sort_col.replace(/\D/g,"");a.pgrid_sort_col=parseInt(a.pgrid_sort_col);
if(a.pgrid_sort_ord!="desc")a.pgrid_sort_ord="asc";f=a.pgrid_sortable;a.pgrid_sortable=!0;a.do_sort(a.pgrid_sort_col,!0);a.pgrid_sortable=f}a.pgrid_paginate&&(a.addClass("ui-pgrid-paginated"),a.pgrid_footer&&a.footer.append(b("<div />").addClass("ui-pgrid-footer-pager-container").each(function(){b(this).append("Display ").append(b("<input />").addClass("ui-widget ui-widget-content ui-corner-all ui-pgrid-per-page").attr({type:"text",value:a.pgrid_perpage}).change(function(){var d=b(this);a.set_per_page(Math.abs(parseInt(d.val())));
d.val(a.pgrid_perpage)})).append(" ").append(b('<button type="button">&lt;&lt; Start</button>').addClass("ui-state-default ui-corner-all").click(function(){a.pagestart()})).append(b('<button type="button">&lt; Prev</button>').addClass("ui-state-default ui-corner-all").click(function(){a.pageprev()})).append(" Page ").append(b("<input />").addClass("ui-widget ui-widget-content ui-corner-all ui-pgrid-page-number").attr({type:"text",value:a.pgrid_page,size:"3"}).change(function(){a.pagenum(Math.abs(parseInt(b(this).val()))-
1)})).append(' of <span class="ui-pgrid-page-total">1</span> ').append(b('<button type="button">Next &gt;</button>').addClass("ui-state-default ui-corner-all").click(function(){a.pagenext()})).append(b('<button type="button">End &gt;&gt;</button>').addClass("ui-state-default ui-corner-all").click(function(){a.pageend()}))})),a.paginate(!0));a.pgrid_footer&&a.pgrid_count&&(a.footer.append(b("<div />").addClass("ui-pgrid-footer-count-container").each(function(){var d=b(this);a.pgrid_select&&d.append(b('<span><span class="ui-pgrid-footer-count-select">0</span> selected of </span>'));
d.append(b('<span><span class="ui-pgrid-footer-count-total">0</span> rows</span>'))})),a.update_selected());if(a.pgrid_footer&&a.pgrid_resize){var i,o,p=function(b){o+=b.pageY-i;i=b.pageY;a.pgrid_table_viewport.css("height",o+"px");return!1};a.footer.append(b("<div />").addClass("ui-pgrid-footer-resize-container").append(b('<span class="ui-icon ui-icon-grip-solid-horizontal"></span>')).mousedown(function(c){i=c.pageY;o=a.pgrid_table_viewport.height();b("body").delegate("*","mousemove",p)}).mouseup(function(){b("body").undelegate("*",
"mousemove",p);a.state_changed()}))}a.pgrid_toolbar&&a.pgrid_widget.append(b("<div />").addClass("ui-pgrid-toolbar-container ui-widget-header ui-corner-top").append(a.toolbar));a.pgrid_widget.append(a.pgrid_table_viewport);a.pgrid_footer&&a.pgrid_widget.append(a.footer);a.pgrid_widget.append(a.pgrid_header_select);this.pines_grid=a});return this};var n=function(b){return encodeURIComponent?encodeURIComponent(b):escape(b)};b.fn.pgrid.defaults={pgrid_toolbar:!1,pgrid_toolbar_contents:[],pgrid_toolbar_target:"_self",
pgrid_footer:!0,pgrid_count:!0,pgrid_select:!0,pgrid_multi_select:!0,pgrid_click:null,pgrid_double_click:null,pgrid_paginate:!0,pgrid_page:0,pgrid_perpage:15,pgrid_filtering:!0,pgrid_filter:"",pgrid_hidden_cols:[],pgrid_resize_cols:!0,pgrid_sortable:!0,pgrid_sort_col:1,pgrid_sort_ord:"asc",pgrid_decimal_sep:".",pgrid_child_prefix:"",pgrid_row_hover_effect:!0,pgrid_view_height:"420px",pgrid_resize:!0,pgrid_state_change:null,pgrid_stateful_height:!0}})(jQuery);
